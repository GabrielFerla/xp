2025-06-15 15:11:00 [main] WARN  org.hibernate.orm.deprecation - HHH90000025: H2Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-06-15 15:11:02 [main] INFO  o.s.s.c.a.a.c.InitializeAuthenticationProviderBeanManagerConfigurer$InitializeAuthenticationProviderManagerConfigurer - Global AuthenticationManager configured with AuthenticationProvider bean with name authenticationProvider
2025-06-15 15:11:02 [main] WARN  o.s.s.c.a.a.c.InitializeUserDetailsBeanManagerConfigurer$InitializeUserDetailsManagerConfigurer - Global AuthenticationManager configured with an AuthenticationProvider bean. UserDetailsService beans will not be used by Spring Security for automatically configuring username/password login. Consider removing the AuthenticationProvider bean. Alternatively, consider using the UserDetailsService in a manually instantiated DaoAuthenticationProvider. If the current configuration is intentional, to turn off this warning, increase the logging level of 'org.springframework.security.config.annotation.authentication.configuration.InitializeUserDetailsBeanManagerConfigurer' to ERROR
2025-06-15 15:11:03 [main] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-06-15 15:11:04 [main] DEBUG o.s.s.web.DefaultSecurityFilterChain - Will secure any request with filters: DisableEncodeUrlFilter, ForceEagerSessionCreationFilter, WebAsyncManagerIntegrationFilter, SecurityContextHolderFilter, HeaderWriterFilter, CsrfFilter, LogoutFilter, JwtAuthenticationFilter, ConcurrentSessionFilter, RequestCacheAwareFilter, SecurityContextHolderAwareRequestFilter, AnonymousAuthenticationFilter, SessionManagementFilter, ExceptionTranslationFilter, AuthorizationFilter
2025-06-15 15:11:05 [main] DEBUG c.x.security.JwtAuthenticationFilter - Filter 'jwtAuthenticationFilter' configured for use
2025-06-15 15:11:05 [scheduling-1] DEBUG c.x.security.AnomalyDetectionService - Anomaly detection service health check: 0 user records, 0 IP records
2025-06-15 15:11:07 [main] DEBUG o.s.security.web.FilterChainProxy - Securing POST /api/auth/authenticate
2025-06-15 15:11:07 [main] DEBUG o.s.s.w.s.ForceEagerSessionCreationFilter - Created session eagerly
2025-06-15 15:11:07 [main] DEBUG o.s.s.w.a.AnonymousAuthenticationFilter - Set SecurityContextHolder to anonymous SecurityContext
2025-06-15 15:11:07 [main] DEBUG o.s.security.web.FilterChainProxy - Secured POST /api/auth/authenticate
2025-06-15 15:11:07 [main] DEBUG o.s.s.a.d.DaoAuthenticationProvider - Failed to find user 'invalid'
2025-06-15 15:11:07 [main] WARN  c.x.s.SecurityAuditEventListener - SECURITY_AUDIT: AUTHENTICATION_FAILURE - User: invalid | Details: unknown | Timestamp: 2025-06-15T15:11:07.419680800
2025-06-15 15:11:07 [main] DEBUG o.s.security.web.FilterChainProxy - Securing POST /api/auth/authenticate
2025-06-15 15:11:07 [main] DEBUG o.s.s.w.s.ForceEagerSessionCreationFilter - Created session eagerly
2025-06-15 15:11:07 [main] DEBUG o.s.s.w.a.AnonymousAuthenticationFilter - Set SecurityContextHolder to anonymous SecurityContext
2025-06-15 15:11:07 [main] DEBUG o.s.security.web.FilterChainProxy - Secured POST /api/auth/authenticate
2025-06-15 15:11:07 [main] DEBUG o.s.s.a.d.DaoAuthenticationProvider - Authenticated user
2025-06-15 15:11:07 [main] INFO  c.x.s.SecurityAuditEventListener - SECURITY_AUDIT: AUTHENTICATION_SUCCESS - User: admin | Authorities: [ROLE_ADMIN] | Timestamp: 2025-06-15T15:11:07.532372
2025-06-15 15:11:07 [main] INFO  c.x.s.SecurityAuditEventListener - LGPD_AUDIT: USER_LOGIN - Requestor: anonymousUser | DataSubject: admin | Details: User successfully authenticated | Timestamp: 2025-06-15T15:11:07.534579600
2025-06-15 15:11:07 [main] DEBUG o.s.s.w.c.HttpSessionSecurityContextRepository - Created HttpSession as SecurityContext is non-default
2025-06-15 15:11:07 [main] DEBUG o.s.s.w.c.HttpSessionSecurityContextRepository - Stored SecurityContextImpl [Authentication=UsernamePasswordAuthenticationToken [Principal=org.springframework.security.core.userdetails.User [Username=user, Password=[PROTECTED], Enabled=true, AccountNonExpired=true, CredentialsNonExpired=true, AccountNonLocked=true, Granted Authorities=[ROLE_USER]], Credentials=[PROTECTED], Authenticated=true, Details=null, Granted Authorities=[ROLE_USER]]] to HttpSession [org.springframework.mock.web.MockHttpSession@1a2b0708]
2025-06-15 15:11:07 [main] DEBUG o.s.security.web.FilterChainProxy - Securing GET /api/customers
2025-06-15 15:11:07 [main] DEBUG o.s.s.w.s.ForceEagerSessionCreationFilter - Created session eagerly
2025-06-15 15:11:07 [main] DEBUG o.s.s.w.c.HttpSessionSecurityContextRepository - Retrieved SecurityContextImpl [Authentication=UsernamePasswordAuthenticationToken [Principal=org.springframework.security.core.userdetails.User [Username=user, Password=[PROTECTED], Enabled=true, AccountNonExpired=true, CredentialsNonExpired=true, AccountNonLocked=true, Granted Authorities=[ROLE_USER]], Credentials=[PROTECTED], Authenticated=true, Details=null, Granted Authorities=[ROLE_USER]]]
2025-06-15 15:11:07 [main] DEBUG o.s.security.web.FilterChainProxy - Secured GET /api/customers
2025-06-15 15:11:07 [main] DEBUG c.x.security.AnomalyDetectionService - New location detected for IP: 127.0.0.1
2025-06-15 15:11:07 [main] ERROR c.x.s.SecurityAuditEventListener - SECURITY_AUDIT: SECURITY_VIOLATION - User: user | Violation: Login from new geographical location | Details: IP: 127.0.0.1 | Time: 2025-06-15T15:11:07.617074400 | Timestamp: 2025-06-15T15:11:07.617074400
2025-06-15 15:11:07 [main] WARN  c.x.security.AnomalyDetectionService - ANOMALY_DETECTED: User: user | Type: Login from new geographical location | IP: 127.0.0.1 | Time: 2025-06-15T15:11:07.617074400
2025-06-15 15:11:07 [main] INFO  c.x.s.SecurityAuditEventListener - SECURITY_AUDIT: DATA_ACCESS - User: user | Resource: /api/customers | Action: GET | Info: User: user | IP: 127.0.0.1 | Timestamp: 2025-06-15T15:11:07.617074400
2025-06-15 15:11:07 [main] DEBUG o.s.security.web.FilterChainProxy - Securing POST /api/auth/register
2025-06-15 15:11:07 [main] DEBUG o.s.s.w.s.ForceEagerSessionCreationFilter - Created session eagerly
2025-06-15 15:11:07 [main] DEBUG o.s.s.w.a.AnonymousAuthenticationFilter - Set SecurityContextHolder to anonymous SecurityContext
2025-06-15 15:11:07 [main] DEBUG o.s.security.web.FilterChainProxy - Secured POST /api/auth/register
2025-06-15 15:11:07 [main] INFO  c.x.s.SecurityAuditEventListener - LGPD_AUDIT: USER_REGISTRATION - Requestor: anonymousUser | DataSubject: newuser123 | Details: New user registered in the system | Timestamp: 2025-06-15T15:11:07.721993700
2025-06-15 15:11:07 [main] DEBUG o.s.s.w.c.HttpSessionSecurityContextRepository - Created HttpSession as SecurityContext is non-default
2025-06-15 15:11:07 [main] DEBUG o.s.s.w.c.HttpSessionSecurityContextRepository - Stored SecurityContextImpl [Authentication=UsernamePasswordAuthenticationToken [Principal=org.springframework.security.core.userdetails.User [Username=user, Password=[PROTECTED], Enabled=true, AccountNonExpired=true, CredentialsNonExpired=true, AccountNonLocked=true, Granted Authorities=[ROLE_USER]], Credentials=[PROTECTED], Authenticated=true, Details=null, Granted Authorities=[ROLE_USER]]] to HttpSession [org.springframework.mock.web.MockHttpSession@6dd55493]
2025-06-15 15:11:07 [main] DEBUG o.s.security.web.FilterChainProxy - Securing GET /api/products
2025-06-15 15:11:07 [main] DEBUG o.s.s.w.s.ForceEagerSessionCreationFilter - Created session eagerly
2025-06-15 15:11:07 [main] DEBUG o.s.security.web.FilterChainProxy - Secured GET /api/products
2025-06-15 15:11:07 [main] DEBUG o.s.s.w.c.HttpSessionSecurityContextRepository - Retrieved SecurityContextImpl [Authentication=UsernamePasswordAuthenticationToken [Principal=org.springframework.security.core.userdetails.User [Username=user, Password=[PROTECTED], Enabled=true, AccountNonExpired=true, CredentialsNonExpired=true, AccountNonLocked=true, Granted Authorities=[ROLE_USER]], Credentials=[PROTECTED], Authenticated=true, Details=null, Granted Authorities=[ROLE_USER]]]
2025-06-15 15:11:07 [main] INFO  c.x.s.SecurityAuditEventListener - SECURITY_AUDIT: DATA_ACCESS - User: user | Resource: /api/products | Action: GET | Info: User: user | IP: 127.0.0.1 | Timestamp: 2025-06-15T15:11:07.733036200
2025-06-15 15:11:07 [main] DEBUG o.s.s.w.c.HttpSessionSecurityContextRepository - Created HttpSession as SecurityContext is non-default
2025-06-15 15:11:07 [main] DEBUG o.s.s.w.c.HttpSessionSecurityContextRepository - Stored SecurityContextImpl [Authentication=UsernamePasswordAuthenticationToken [Principal=org.springframework.security.core.userdetails.User [Username=admin, Password=[PROTECTED], Enabled=true, AccountNonExpired=true, CredentialsNonExpired=true, AccountNonLocked=true, Granted Authorities=[ROLE_ADMIN]], Credentials=[PROTECTED], Authenticated=true, Details=null, Granted Authorities=[ROLE_ADMIN]]] to HttpSession [org.springframework.mock.web.MockHttpSession@98925d]
2025-06-15 15:11:07 [main] DEBUG o.s.security.web.FilterChainProxy - Securing GET /api/customers
2025-06-15 15:11:07 [main] DEBUG o.s.s.w.s.ForceEagerSessionCreationFilter - Created session eagerly
2025-06-15 15:11:07 [main] DEBUG o.s.s.w.c.HttpSessionSecurityContextRepository - Retrieved SecurityContextImpl [Authentication=UsernamePasswordAuthenticationToken [Principal=org.springframework.security.core.userdetails.User [Username=admin, Password=[PROTECTED], Enabled=true, AccountNonExpired=true, CredentialsNonExpired=true, AccountNonLocked=true, Granted Authorities=[ROLE_ADMIN]], Credentials=[PROTECTED], Authenticated=true, Details=null, Granted Authorities=[ROLE_ADMIN]]]
2025-06-15 15:11:07 [main] DEBUG o.s.security.web.FilterChainProxy - Secured GET /api/customers
2025-06-15 15:11:07 [main] INFO  c.x.s.SecurityAuditEventListener - SECURITY_AUDIT: DATA_ACCESS - User: admin | Resource: /api/customers | Action: GET | Info: User: admin | IP: 127.0.0.1 | Timestamp: 2025-06-15T15:11:07.752938100
2025-06-15 15:11:07 [main] DEBUG o.s.security.web.FilterChainProxy - Securing GET /api/products
2025-06-15 15:11:07 [main] DEBUG o.s.s.w.s.ForceEagerSessionCreationFilter - Created session eagerly
2025-06-15 15:11:07 [main] DEBUG o.s.s.w.a.AnonymousAuthenticationFilter - Set SecurityContextHolder to anonymous SecurityContext
2025-06-15 15:11:07 [main] DEBUG o.s.security.web.FilterChainProxy - Secured GET /api/products
2025-06-15 15:11:07 [main] INFO  c.x.s.SecurityAuditEventListener - SECURITY_AUDIT: DATA_ACCESS - User: anonymousUser | Resource: /api/products | Action: GET | Info: User: anonymousUser | IP: 127.0.0.1 | Timestamp: 2025-06-15T15:11:07.800219600
2025-06-15 15:11:07 [main] DEBUG c.x.security.AnomalyDetectionService - New location detected for IP: 192.168.1.200
2025-06-15 15:11:07 [main] ERROR c.x.s.SecurityAuditEventListener - SECURITY_AUDIT: SECURITY_VIOLATION - User: anonymous | Violation: Login from new geographical location | Details: IP: 192.168.1.200 | Time: 2025-06-15T15:11:07.812514500 | Timestamp: 2025-06-15T15:11:07.812514500
2025-06-15 15:11:07 [main] WARN  c.x.security.AnomalyDetectionService - ANOMALY_DETECTED: User: anomalyuser | Type: Login from new geographical location | IP: 192.168.1.200 | Time: 2025-06-15T15:11:07.812514500
2025-06-15 15:11:07 [main] DEBUG c.x.security.AnomalyDetectionService - Anomaly detection service health check: 4 user records, 2 IP records
2025-06-15 15:11:07 [main] DEBUG o.s.security.web.FilterChainProxy - Securing POST /api/auth/register
2025-06-15 15:11:07 [main] DEBUG o.s.s.w.s.ForceEagerSessionCreationFilter - Created session eagerly
2025-06-15 15:11:07 [main] DEBUG o.s.s.w.a.AnonymousAuthenticationFilter - Set SecurityContextHolder to anonymous SecurityContext
2025-06-15 15:11:07 [main] DEBUG o.s.security.web.FilterChainProxy - Secured POST /api/auth/register
2025-06-15 15:11:07 [main] DEBUG o.s.security.web.FilterChainProxy - Securing POST /api/auth/register
2025-06-15 15:11:07 [main] DEBUG o.s.s.w.s.ForceEagerSessionCreationFilter - Created session eagerly
2025-06-15 15:11:07 [main] DEBUG o.s.security.web.csrf.CsrfFilter - Invalid CSRF token found for http://localhost/api/auth/register
2025-06-15 15:11:07 [main] DEBUG o.s.s.w.a.AccessDeniedHandlerImpl - Responding with 403 status code
2025-06-15 15:11:07 [main] DEBUG o.s.s.w.c.HttpSessionSecurityContextRepository - Created HttpSession as SecurityContext is non-default
2025-06-15 15:11:07 [main] DEBUG o.s.s.w.c.HttpSessionSecurityContextRepository - Stored SecurityContextImpl [Authentication=UsernamePasswordAuthenticationToken [Principal=org.springframework.security.core.userdetails.User [Username=testuser, Password=[PROTECTED], Enabled=true, AccountNonExpired=true, CredentialsNonExpired=true, AccountNonLocked=true, Granted Authorities=[ROLE_USER]], Credentials=[PROTECTED], Authenticated=true, Details=null, Granted Authorities=[ROLE_USER]]] to HttpSession [org.springframework.mock.web.MockHttpSession@19a834b]
2025-06-15 15:11:07 [main] DEBUG o.s.security.web.FilterChainProxy - Securing POST /api/lgpd/export
2025-06-15 15:11:07 [main] DEBUG o.s.s.w.s.ForceEagerSessionCreationFilter - Created session eagerly
2025-06-15 15:11:07 [main] DEBUG o.s.s.w.c.HttpSessionSecurityContextRepository - Retrieved SecurityContextImpl [Authentication=UsernamePasswordAuthenticationToken [Principal=org.springframework.security.core.userdetails.User [Username=testuser, Password=[PROTECTED], Enabled=true, AccountNonExpired=true, CredentialsNonExpired=true, AccountNonLocked=true, Granted Authorities=[ROLE_USER]], Credentials=[PROTECTED], Authenticated=true, Details=null, Granted Authorities=[ROLE_USER]]]
2025-06-15 15:11:07 [main] DEBUG o.s.security.web.FilterChainProxy - Secured POST /api/lgpd/export
2025-06-15 15:11:07 [main] INFO  c.x.s.SecurityAuditEventListener - SECURITY_AUDIT: DATA_ACCESS - User: testuser | Resource: /api/lgpd/export | Action: POST | Info: User: testuser | IP: 127.0.0.1 | Timestamp: 2025-06-15T15:11:07.858714
2025-06-15 15:11:07 [main] DEBUG o.s.s.a.m.AuthorizationManagerBeforeMethodInterceptor - Authorizing method invocation ReflectiveMethodInvocation: public org.springframework.http.ResponseEntity com.xp.controller.LGPDController.exportUserData(com.xp.dto.DataExportRequest); target is of class [com.xp.controller.LGPDController]
2025-06-15 15:11:07 [main] DEBUG o.s.s.a.m.AuthorizationManagerBeforeMethodInterceptor - Authorized method invocation ReflectiveMethodInvocation: public org.springframework.http.ResponseEntity com.xp.controller.LGPDController.exportUserData(com.xp.dto.DataExportRequest); target is of class [com.xp.controller.LGPDController]
2025-06-15 15:11:07 [main] INFO  c.x.s.SecurityAuditEventListener - LGPD_AUDIT: DATA_EXPORT - Requestor: testuser | DataSubject: admin | Details: User data exported for LGPD compliance | Timestamp: 2025-06-15T15:11:07.884986200
2025-06-15 15:11:07 [main] INFO  c.x.s.SecurityAuditEventListener - SECURITY_AUDIT: MFA_SECRET_GENERATED - User: testuser | Details: MFA secret generated for user | Timestamp: 2025-06-15T15:11:07.898013700
2025-06-15 15:11:07 [main] INFO  com.xp.security.MFAService - MFA secret generated for user: testuser
2025-06-15 15:11:07 [main] INFO  c.x.s.SecurityAuditEventListener - SECURITY_AUDIT: MFA_BACKUP_CODES_GENERATED - User: testuser | Details: Backup codes generated | Timestamp: 2025-06-15T15:11:07.899014600
2025-06-15 15:11:07 [main] INFO  com.xp.security.MFAService - Backup codes generated for user: testuser
2025-06-15 15:11:07 [main] INFO  c.x.s.SecurityAuditEventListener - SECURITY_AUDIT: MFA_DISABLED - User: testuser | Details: MFA disabled for user | Timestamp: 2025-06-15T15:11:07.899014600
2025-06-15 15:11:07 [main] INFO  com.xp.security.MFAService - MFA disabled for user: testuser
2025-06-15 15:11:07 [main] DEBUG o.s.security.web.FilterChainProxy - Securing GET /api/products
2025-06-15 15:11:07 [main] DEBUG o.s.s.w.s.ForceEagerSessionCreationFilter - Created session eagerly
2025-06-15 15:11:07 [main] DEBUG o.s.s.w.a.AnonymousAuthenticationFilter - Set SecurityContextHolder to anonymous SecurityContext
2025-06-15 15:11:07 [main] DEBUG o.s.security.web.FilterChainProxy - Secured GET /api/products
2025-06-15 15:11:07 [main] ERROR c.x.s.SecurityAuditEventListener - SECURITY_AUDIT: SECURITY_VIOLATION - User: anonymousUser | Violation: SQL_INJECTION_ATTEMPT | Details: User: anonymousUser | IP: 127.0.0.1 | Parameter: id | Value: '; DROP TABLE products; -- | Timestamp: 2025-06-15T15:11:07.906799600
2025-06-15 15:11:07 [main] INFO  c.x.s.SecurityAuditEventListener - SECURITY_AUDIT: DATA_ACCESS - User: anonymousUser | Resource: /api/products | Action: GET | Info: User: anonymousUser | IP: 127.0.0.1 | Timestamp: 2025-06-15T15:11:07.906799600
2025-06-15 15:11:07 [main] DEBUG o.s.s.w.c.HttpSessionSecurityContextRepository - Created HttpSession as SecurityContext is non-default
2025-06-15 15:11:07 [main] DEBUG o.s.s.w.c.HttpSessionSecurityContextRepository - Stored SecurityContextImpl [Authentication=UsernamePasswordAuthenticationToken [Principal=org.springframework.security.core.userdetails.User [Username=admin, Password=[PROTECTED], Enabled=true, AccountNonExpired=true, CredentialsNonExpired=true, AccountNonLocked=true, Granted Authorities=[ROLE_ADMIN]], Credentials=[PROTECTED], Authenticated=true, Details=null, Granted Authorities=[ROLE_ADMIN]]] to HttpSession [org.springframework.mock.web.MockHttpSession@4a229e9d]
2025-06-15 15:11:07 [main] DEBUG o.s.security.web.FilterChainProxy - Securing GET /api/admin/users
2025-06-15 15:11:07 [main] DEBUG o.s.s.w.s.ForceEagerSessionCreationFilter - Created session eagerly
2025-06-15 15:11:07 [main] DEBUG o.s.s.w.c.HttpSessionSecurityContextRepository - Retrieved SecurityContextImpl [Authentication=UsernamePasswordAuthenticationToken [Principal=org.springframework.security.core.userdetails.User [Username=admin, Password=[PROTECTED], Enabled=true, AccountNonExpired=true, CredentialsNonExpired=true, AccountNonLocked=true, Granted Authorities=[ROLE_ADMIN]], Credentials=[PROTECTED], Authenticated=true, Details=null, Granted Authorities=[ROLE_ADMIN]]]
2025-06-15 15:11:07 [main] DEBUG o.s.security.web.FilterChainProxy - Secured GET /api/admin/users
2025-06-15 15:11:07 [main] INFO  c.x.s.SecurityAuditEventListener - SECURITY_AUDIT: DATA_ACCESS - User: admin | Resource: /api/admin/users | Action: GET | Info: User: admin | IP: 127.0.0.1 | Timestamp: 2025-06-15T15:11:07.918301500
2025-06-15 15:11:07 [main] DEBUG o.s.s.a.m.AuthorizationManagerBeforeMethodInterceptor - Authorizing method invocation ReflectiveMethodInvocation: public org.springframework.http.ResponseEntity com.xp.controller.AdminController.getAllUsers(); target is of class [com.xp.controller.AdminController]
2025-06-15 15:11:07 [main] DEBUG o.s.s.a.m.AuthorizationManagerBeforeMethodInterceptor - Authorized method invocation ReflectiveMethodInvocation: public org.springframework.http.ResponseEntity com.xp.controller.AdminController.getAllUsers(); target is of class [com.xp.controller.AdminController]
2025-06-15 15:11:07 [main] DEBUG o.s.security.web.FilterChainProxy - Securing GET /api/products
2025-06-15 15:11:07 [main] DEBUG o.s.s.w.s.ForceEagerSessionCreationFilter - Created session eagerly
2025-06-15 15:11:07 [main] DEBUG o.s.s.w.a.AnonymousAuthenticationFilter - Set SecurityContextHolder to anonymous SecurityContext
2025-06-15 15:11:07 [main] DEBUG o.s.security.web.FilterChainProxy - Secured GET /api/products
2025-06-15 15:11:07 [main] INFO  c.x.s.SecurityAuditEventListener - SECURITY_AUDIT: DATA_ACCESS - User: anonymousUser | Resource: /api/products | Action: GET | Info: User: anonymousUser | IP: 127.0.0.1 | Timestamp: 2025-06-15T15:11:07.930265900
2025-06-15 15:11:07 [main] DEBUG o.s.s.w.c.HttpSessionSecurityContextRepository - Created HttpSession as SecurityContext is non-default
2025-06-15 15:11:07 [main] DEBUG o.s.s.w.c.HttpSessionSecurityContextRepository - Stored SecurityContextImpl [Authentication=UsernamePasswordAuthenticationToken [Principal=org.springframework.security.core.userdetails.User [Username=user, Password=[PROTECTED], Enabled=true, AccountNonExpired=true, CredentialsNonExpired=true, AccountNonLocked=true, Granted Authorities=[ROLE_USER]], Credentials=[PROTECTED], Authenticated=true, Details=null, Granted Authorities=[ROLE_USER]]] to HttpSession [org.springframework.mock.web.MockHttpSession@659ba3a1]
2025-06-15 15:11:07 [main] DEBUG o.s.security.web.FilterChainProxy - Securing GET /api/admin/users
2025-06-15 15:11:07 [main] DEBUG o.s.s.w.s.ForceEagerSessionCreationFilter - Created session eagerly
2025-06-15 15:11:07 [main] DEBUG o.s.s.w.c.HttpSessionSecurityContextRepository - Retrieved SecurityContextImpl [Authentication=UsernamePasswordAuthenticationToken [Principal=org.springframework.security.core.userdetails.User [Username=user, Password=[PROTECTED], Enabled=true, AccountNonExpired=true, CredentialsNonExpired=true, AccountNonLocked=true, Granted Authorities=[ROLE_USER]], Credentials=[PROTECTED], Authenticated=true, Details=null, Granted Authorities=[ROLE_USER]]]
2025-06-15 15:11:07 [main] DEBUG o.s.security.web.FilterChainProxy - Secured GET /api/admin/users
2025-06-15 15:11:07 [main] INFO  c.x.s.SecurityAuditEventListener - SECURITY_AUDIT: DATA_ACCESS - User: user | Resource: /api/admin/users | Action: GET | Info: User: user | IP: 127.0.0.1 | Timestamp: 2025-06-15T15:11:07.948669700
2025-06-15 15:11:07 [main] DEBUG o.s.s.a.m.AuthorizationManagerBeforeMethodInterceptor - Authorizing method invocation ReflectiveMethodInvocation: public org.springframework.http.ResponseEntity com.xp.controller.AdminController.getAllUsers(); target is of class [com.xp.controller.AdminController]
2025-06-15 15:11:07 [main] DEBUG o.s.s.a.m.AuthorizationManagerBeforeMethodInterceptor - Failed to authorize ReflectiveMethodInvocation: public org.springframework.http.ResponseEntity com.xp.controller.AdminController.getAllUsers(); target is of class [com.xp.controller.AdminController] with authorization manager org.springframework.security.authorization.ObservationAuthorizationManager@4fe57305 and result ExpressionAuthorizationDecision [granted=false, expressionAttribute=hasRole('ADMIN')]
2025-06-15 15:11:07 [main] DEBUG o.s.s.w.c.HttpSessionSecurityContextRepository - Created HttpSession as SecurityContext is non-default
2025-06-15 15:11:07 [main] DEBUG o.s.s.w.c.HttpSessionSecurityContextRepository - Stored SecurityContextImpl [Authentication=UsernamePasswordAuthenticationToken [Principal=org.springframework.security.core.userdetails.User [Username=testuser, Password=[PROTECTED], Enabled=true, AccountNonExpired=true, CredentialsNonExpired=true, AccountNonLocked=true, Granted Authorities=[ROLE_USER]], Credentials=[PROTECTED], Authenticated=true, Details=null, Granted Authorities=[ROLE_USER]]] to HttpSession [org.springframework.mock.web.MockHttpSession@12734eb5]
2025-06-15 15:11:07 [main] DEBUG o.s.security.web.FilterChainProxy - Securing POST /api/lgpd/delete
2025-06-15 15:11:07 [main] DEBUG o.s.s.w.s.ForceEagerSessionCreationFilter - Created session eagerly
2025-06-15 15:11:07 [main] DEBUG o.s.s.w.c.HttpSessionSecurityContextRepository - Retrieved SecurityContextImpl [Authentication=UsernamePasswordAuthenticationToken [Principal=org.springframework.security.core.userdetails.User [Username=testuser, Password=[PROTECTED], Enabled=true, AccountNonExpired=true, CredentialsNonExpired=true, AccountNonLocked=true, Granted Authorities=[ROLE_USER]], Credentials=[PROTECTED], Authenticated=true, Details=null, Granted Authorities=[ROLE_USER]]]
2025-06-15 15:11:07 [main] DEBUG o.s.security.web.FilterChainProxy - Secured POST /api/lgpd/delete
2025-06-15 15:11:07 [main] INFO  c.x.s.SecurityAuditEventListener - SECURITY_AUDIT: DATA_ACCESS - User: testuser | Resource: /api/lgpd/delete | Action: POST | Info: User: testuser | IP: 127.0.0.1 | Timestamp: 2025-06-15T15:11:07.962963200
2025-06-15 15:11:07 [main] DEBUG o.s.s.a.m.AuthorizationManagerBeforeMethodInterceptor - Authorizing method invocation ReflectiveMethodInvocation: public org.springframework.http.ResponseEntity com.xp.controller.LGPDController.deleteUserData(com.xp.dto.DataDeletionRequest); target is of class [com.xp.controller.LGPDController]
2025-06-15 15:11:07 [main] DEBUG o.s.s.a.m.AuthorizationManagerBeforeMethodInterceptor - Authorized method invocation ReflectiveMethodInvocation: public org.springframework.http.ResponseEntity com.xp.controller.LGPDController.deleteUserData(com.xp.dto.DataDeletionRequest); target is of class [com.xp.controller.LGPDController]
2025-06-15 15:11:07 [main] INFO  c.x.s.SecurityAuditEventListener - LGPD_AUDIT: DATA_DELETION - Requestor: testuser | DataSubject: admin | Details: User data deletion requested. Reason: User requested account deletion | Timestamp: 2025-06-15T15:11:07.976011300
2025-06-15 15:11:07 [main] DEBUG c.xp.security.DataEncryptionService - Encrypting PII data for context: user_profile
2025-06-15 15:11:07 [main] DEBUG c.xp.security.DataEncryptionService - Decrypting PII data for context: user_profile
2025-06-15 15:11:08 [main] WARN  org.hibernate.orm.deprecation - HHH90000025: H2Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-06-15 15:11:09 [main] INFO  o.s.s.c.a.a.c.InitializeAuthenticationProviderBeanManagerConfigurer$InitializeAuthenticationProviderManagerConfigurer - Global AuthenticationManager configured with AuthenticationProvider bean with name authenticationProvider
2025-06-15 15:11:09 [main] WARN  o.s.s.c.a.a.c.InitializeUserDetailsBeanManagerConfigurer$InitializeUserDetailsManagerConfigurer - Global AuthenticationManager configured with an AuthenticationProvider bean. UserDetailsService beans will not be used by Spring Security for automatically configuring username/password login. Consider removing the AuthenticationProvider bean. Alternatively, consider using the UserDetailsService in a manually instantiated DaoAuthenticationProvider. If the current configuration is intentional, to turn off this warning, increase the logging level of 'org.springframework.security.config.annotation.authentication.configuration.InitializeUserDetailsBeanManagerConfigurer' to ERROR
2025-06-15 15:11:09 [main] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-06-15 15:11:10 [main] DEBUG o.s.s.web.DefaultSecurityFilterChain - Will secure any request with filters: DisableEncodeUrlFilter, ForceEagerSessionCreationFilter, WebAsyncManagerIntegrationFilter, SecurityContextHolderFilter, HeaderWriterFilter, CsrfFilter, LogoutFilter, JwtAuthenticationFilter, ConcurrentSessionFilter, RequestCacheAwareFilter, SecurityContextHolderAwareRequestFilter, AnonymousAuthenticationFilter, SessionManagementFilter, ExceptionTranslationFilter, AuthorizationFilter
2025-06-15 15:11:10 [main] DEBUG c.x.security.JwtAuthenticationFilter - Filter 'jwtAuthenticationFilter' configured for use
2025-06-15 15:11:10 [scheduling-1] DEBUG c.x.security.AnomalyDetectionService - Anomaly detection service health check: 0 user records, 0 IP records
2025-06-15 15:11:11 [main] DEBUG o.s.s.w.c.HttpSessionSecurityContextRepository - Created HttpSession as SecurityContext is non-default
2025-06-15 15:11:11 [main] DEBUG o.s.s.w.c.HttpSessionSecurityContextRepository - Stored SecurityContextImpl [Authentication=UsernamePasswordAuthenticationToken [Principal=org.springframework.security.core.userdetails.User [Username=user, Password=[PROTECTED], Enabled=true, AccountNonExpired=true, CredentialsNonExpired=true, AccountNonLocked=true, Granted Authorities=[ROLE_USER]], Credentials=[PROTECTED], Authenticated=true, Details=null, Granted Authorities=[ROLE_USER]]] to HttpSession [org.springframework.mock.web.MockHttpSession@25e085d7]
2025-06-15 15:11:11 [main] DEBUG o.s.security.web.FilterChainProxy - Securing POST /api/products
2025-06-15 15:11:11 [main] DEBUG o.s.s.w.s.ForceEagerSessionCreationFilter - Created session eagerly
2025-06-15 15:11:11 [main] DEBUG o.s.s.w.c.HttpSessionSecurityContextRepository - Retrieved SecurityContextImpl [Authentication=UsernamePasswordAuthenticationToken [Principal=org.springframework.security.core.userdetails.User [Username=user, Password=[PROTECTED], Enabled=true, AccountNonExpired=true, CredentialsNonExpired=true, AccountNonLocked=true, Granted Authorities=[ROLE_USER]], Credentials=[PROTECTED], Authenticated=true, Details=null, Granted Authorities=[ROLE_USER]]]
2025-06-15 15:11:11 [main] DEBUG o.s.security.web.FilterChainProxy - Secured POST /api/products
2025-06-15 15:11:11 [main] DEBUG c.x.security.AnomalyDetectionService - New location detected for IP: 127.0.0.1
2025-06-15 15:11:11 [main] ERROR c.x.s.SecurityAuditEventListener - SECURITY_AUDIT: SECURITY_VIOLATION - User: user | Violation: Login from new geographical location | Details: IP: 127.0.0.1 | Time: 2025-06-15T15:11:11.170894300 | Timestamp: 2025-06-15T15:11:11.170894300
2025-06-15 15:11:11 [main] WARN  c.x.security.AnomalyDetectionService - ANOMALY_DETECTED: User: user | Type: Login from new geographical location | IP: 127.0.0.1 | Time: 2025-06-15T15:11:11.172423200
2025-06-15 15:11:11 [main] INFO  c.x.s.SecurityAuditEventListener - SECURITY_AUDIT: DATA_ACCESS - User: user | Resource: /api/products | Action: POST | Info: User: user | IP: 127.0.0.1 | Timestamp: 2025-06-15T15:11:11.172423200
2025-06-15 15:11:11 [main] DEBUG o.s.s.w.c.HttpSessionSecurityContextRepository - Created HttpSession as SecurityContext is non-default
2025-06-15 15:11:11 [main] DEBUG o.s.s.w.c.HttpSessionSecurityContextRepository - Stored SecurityContextImpl [Authentication=UsernamePasswordAuthenticationToken [Principal=org.springframework.security.core.userdetails.User [Username=user, Password=[PROTECTED], Enabled=true, AccountNonExpired=true, CredentialsNonExpired=true, AccountNonLocked=true, Granted Authorities=[ROLE_USER]], Credentials=[PROTECTED], Authenticated=true, Details=null, Granted Authorities=[ROLE_USER]]] to HttpSession [org.springframework.mock.web.MockHttpSession@3bead9b5]
2025-06-15 15:11:11 [main] DEBUG o.s.security.web.FilterChainProxy - Securing GET /api/products/1
2025-06-15 15:11:11 [main] DEBUG o.s.s.w.s.ForceEagerSessionCreationFilter - Created session eagerly
2025-06-15 15:11:11 [main] DEBUG o.s.security.web.FilterChainProxy - Secured GET /api/products/1
2025-06-15 15:11:11 [main] DEBUG o.s.s.w.c.HttpSessionSecurityContextRepository - Retrieved SecurityContextImpl [Authentication=UsernamePasswordAuthenticationToken [Principal=org.springframework.security.core.userdetails.User [Username=user, Password=[PROTECTED], Enabled=true, AccountNonExpired=true, CredentialsNonExpired=true, AccountNonLocked=true, Granted Authorities=[ROLE_USER]], Credentials=[PROTECTED], Authenticated=true, Details=null, Granted Authorities=[ROLE_USER]]]
2025-06-15 15:11:11 [main] INFO  c.x.s.SecurityAuditEventListener - SECURITY_AUDIT: DATA_ACCESS - User: user | Resource: /api/products/1 | Action: GET | Info: User: user | IP: 127.0.0.1 | Timestamp: 2025-06-15T15:11:11.219521400
2025-06-15 15:11:11 [main] DEBUG o.s.s.w.c.HttpSessionSecurityContextRepository - Created HttpSession as SecurityContext is non-default
2025-06-15 15:11:11 [main] DEBUG o.s.s.w.c.HttpSessionSecurityContextRepository - Stored SecurityContextImpl [Authentication=UsernamePasswordAuthenticationToken [Principal=org.springframework.security.core.userdetails.User [Username=user, Password=[PROTECTED], Enabled=true, AccountNonExpired=true, CredentialsNonExpired=true, AccountNonLocked=true, Granted Authorities=[ROLE_USER]], Credentials=[PROTECTED], Authenticated=true, Details=null, Granted Authorities=[ROLE_USER]]] to HttpSession [org.springframework.mock.web.MockHttpSession@512d8b67]
2025-06-15 15:11:11 [main] DEBUG o.s.security.web.FilterChainProxy - Securing GET /api/products
2025-06-15 15:11:11 [main] DEBUG o.s.s.w.s.ForceEagerSessionCreationFilter - Created session eagerly
2025-06-15 15:11:11 [main] DEBUG o.s.security.web.FilterChainProxy - Secured GET /api/products
2025-06-15 15:11:11 [main] DEBUG o.s.s.w.c.HttpSessionSecurityContextRepository - Retrieved SecurityContextImpl [Authentication=UsernamePasswordAuthenticationToken [Principal=org.springframework.security.core.userdetails.User [Username=user, Password=[PROTECTED], Enabled=true, AccountNonExpired=true, CredentialsNonExpired=true, AccountNonLocked=true, Granted Authorities=[ROLE_USER]], Credentials=[PROTECTED], Authenticated=true, Details=null, Granted Authorities=[ROLE_USER]]]
2025-06-15 15:11:11 [main] INFO  c.x.s.SecurityAuditEventListener - SECURITY_AUDIT: DATA_ACCESS - User: user | Resource: /api/products | Action: GET | Info: User: user | IP: 127.0.0.1 | Timestamp: 2025-06-15T15:11:11.242972200
